### 2.3.1 依赖管理和命名约定

依赖管理和依赖注入不是同一个概念，为了在你的应用程序中使用 Spring 的功能（如依赖注入），你需要在编译或运行期将所依赖的库（jar文件）导入到应用的 classpath 中。这些依赖关系通常是文件系统中的物理资源，而非依赖注入概念中由 IoC 容器创建的抽象资源。依赖关系的管理过程包括对这些资源的定位、存储、以及将其添加到 classpath 中。依赖关系可以是直接的（例如应用程序在运行时依赖于 Spring），也可以是间接的（例如应用程序依赖于 commons-pool，而commons-pool 依赖于 commons-dbcp，故应用程序间接依赖于 commons-dbcp）。间接依赖关系也被称为“传递性”依赖，属于最难识别和管理的依赖关系。

如果要使用 Spring，你需要获得一个包含你所需功能的库文件（jar），Spring 被打包为一系列模块，各个模块之间尽可能的分离依赖关系，以便你可以只使用需要的模块而忽略其余模块，例如，如果你不是编写 Web 应用程序，则不需要引入 `spring-web` 模块。Spring 各模块的库文件使用一种简写约定命名，如 `spring-*` 或 `spring-*.jar`，其中 `*` 表示模块名称（如 `spring-core`、 `spring-webmvc`、 `spring-jms` 等）。实际使用的 jar 文件名通常在模块名后以短横线连接了该模块的版本号（如 `spring-core-5.0.0.M4.jar`）。

Spring 框架的每个版本都会将库文件发布到以下位置：

* **[Maven Central](https://search.maven.org)**，Maven 默认的查询仓库，不需要任何特殊配置即可使用，许多 Spring 依赖的库也可以在这里找到，Spring 社区的大部分项目都是使用 Maven 进行依赖管理。在 Maven 中 Spring 模块的 jar 名称（artifactId）是 `spring-*-<version>.jar` 的形式，groupId 为 `org.springframework`。
* **[一个专门用于 Spring 的公共 Maven 仓库](http://maven.springframework.org)**，除了最终的 GA 版本，这个仓库还存储快照版本（[snapshots](http://maven.springframework.org/snapshot)）和里程碑版本（[milestones](http://maven.springframework.org/milestone)）。其中的 jar 文件命名与 Maven Central 一致，这里可以用于获取 Spring 的开发版本，并可以和 Maven Central 配合使用。这里还存储着包含 Spring 所有模块的 zip 文件包，便于一次性下载 Spring 的所有 jar 文件。

你首先需要决定如何管理你的依赖关系，我们建议使用一个自动化的依赖管理工具，如 Maven、 Gradle、 或 Ivy，当然你也可以手动下载所有的 jar 文件。

下表为 Spring 各模块的构件列表，有关各个模块的详细描述可以参考 [2.2 模块](0004-2.2-Modules.md)。

**表 2.1. Spring 框架构件列表**

| GroupId | ArtifactId | Description |
| :--- | :--- | :--- |
| org.springframework | spring-aop | 基于代理的 AOP 支持 |
| org.springframework | spring-aspects | 集成 AspectJ 框架提供切面支持 |
| org.springframework | spring-beans | Bean 支持，包括对 Groovy Bean 的支持 |
| org.springframework | spring-context | 应用程序上下文运行时 |
| org.springframework | spring-context-support | 提供将第三方库集成到 Spring 上下文的类 |
| org.springframework | spring-core | 核心工具模块，其它的 Spring 模块大都依赖它 |
| org.springframework | spring-expression | Spring 表达式语言（SpEL） |
| org.springframework | spring-instrument | Instrumentation 代理 |
| org.springframework | spring-instrument-tomcat | 针对 Tomcat 的 Instrumentation 代理 |
| org.springframework | spring-jdbc | JDBC 编程支持，包括数据源的设置及访问 |
| org.springframework | spring-jms | JMS 支持，包括收发 JMS 消息的辅助类 |
| org.springframework | spring-messaging | 基于消息的应用开发支持 |
| org.springframework | spring-orm | 对象关系映射，支持 JPA、 Hibernate 等 ORM 框架的集成 |
| org.springframework | spring-oxm | 对象XML映射 |
| org.springframework | spring-test | 支持对 Spring 组件的单元测试和集成测试 |
| org.springframework | spring-tx | 事务支持，包括 DAO 支持 和 JCA 集成 |
| org.springframework | spring-web | Web 开发支持，包括 HTTP 客户端和远程处理 |
| org.springframework | spring-webmvc | REST 风格的 Web 服务，以及 MVC 模式的实现 |
| org.springframework | spring-websocket | WebSocket 和 SockJS 的实现，支持 STOMP |

  
#### Spring 依赖管理

Although Spring provides integration and support for a huge range of enterprise and other external tools, it intentionally keeps its mandatory dependencies to an absolute minimum: you shouldn’t have to locate and download \(even automatically\) a large number of jar libraries in order to use Spring for simple use cases. For basic dependency injection there is only one mandatory external dependency, and that is for logging \(see below for a more detailed description of logging options\).

Next we outline the basic steps needed to configure an application that depends on Spring, first with Maven and then with Gradle and finally using Ivy. In all cases, if anything is unclear, refer to the documentation of your dependency management system, or look at some sample code - Spring itself uses Gradle to manage dependencies when it is building, and our samples mostly use Gradle or Maven.


#### Maven Dependency Management

If you are using[Maven](https://maven.apache.org/)for dependency management you don’t even need to supply the logging dependency explicitly. For example, to create an application context and use dependency injection to configure an application, your Maven dependencies will look like this:

```xml
<dependencies>
	<dependency>
		<groupId>org.springframework</groupId>
		<artifactId>spring-context</artifactId>
		<version>5.0.0.M4</version>
		<scope>runtime</scope>
	</dependency>
</dependencies>
```

That’s it. Note the scope can be declared as runtime if you don’t need to compile against Spring APIs, which is typically the case for basic dependency injection use cases.

The example above works with the Maven Central repository. To use the Spring Maven repository \(e.g. for milestones or developer snapshots\), you need to specify the repository location in your Maven configuration. For full releases:

```xml
<repositories>
	<repository>
		<id>io.spring.repo.maven.release</id>
		<url>http://repo.spring.io/release/</url>
		<snapshots><enabled>false</enabled></snapshots>
	</repository>
</repositories>
```

For milestones:

```xml
<repositories>
	<repository>
		<id>io.spring.repo.maven.milestone</id>
		<url>http://repo.spring.io/milestone/</url>
		<snapshots><enabled>false</enabled></snapshots>
	</repository>
</repositories>
```

And for snapshots:

```xml
<repositories>
	<repository>
		<id>io.spring.repo.maven.snapshot</id>
		<url>http://repo.spring.io/snapshot/</url>
		<snapshots><enabled>true</enabled></snapshots>
	</repository>
</repositories>
```

#### Maven "Bill Of Materials" Dependency

It is possible to accidentally mix different versions of Spring JARs when using Maven. For example, you may find that a third-party library, or another Spring project, pulls in a transitive dependency to an older release. If you forget to explicitly declare a direct dependency yourself, all sorts of unexpected issues can arise.

To overcome such problems Maven supports the concept of a "bill of materials" \(BOM\) dependency. You can import the`spring-framework-bom`in your`dependencyManagement`section to ensure that all spring dependencies \(both direct and transitive\) are at the same version.

```xml
<dependencyManagement>
	<dependencies>
		<dependency>
			<groupId>org.springframework</groupId>
			<artifactId>spring-framework-bom</artifactId>
			<version>5.0.0.M4</version>
			<type>pom</type>
			<scope>import</scope>
		</dependency>
	</dependencies>
</dependencyManagement>
```

An added benefit of using the BOM is that you no longer need to specify the `<version>` attribute when depending on Spring Framework artifacts:

```xml
<dependencies>
	<dependency>
		<groupId>org.springframework</groupId>
		<artifactId>spring-context</artifactId>
	</dependency>
	<dependency>
		<groupId>org.springframework</groupId>
		<artifactId>spring-web</artifactId>
	</dependency>
</dependencies>
```

#### Gradle Dependency Management

To use the Spring repository with the[Gradle](http://www.gradle.org/)build system, include the appropriate URL in the`repositories`section:

```yaml
repositories {
	mavenCentral()
	// and optionally...
	maven { url "http://repo.spring.io/release" }
}
```

You can change the `repositories` URL from `/release` to `/milestone` or `/snapshot` as appropriate. Once a repository has been configured, you can declare dependencies in the usual Gradle way:

```yaml
dependencies {
	compile("org.springframework:spring-context:5.0.0.M4")
	testCompile("org.springframework:spring-test:5.0.0.M4")
}
```

#### Ivy Dependency Management

If you prefer to use[Ivy](https://ant.apache.org/ivy)to manage dependencies then there are similar configuration options.

To configure Ivy to point to the Spring repository add the following resolver to your`ivysettings.xml`:

```xml
<resolvers>
	<ibiblio name="io.spring.repo.maven.release"
			m2compatible="true"
			root="http://repo.spring.io/release/"/>
</resolvers>
```

You can change the`root`URL from`/release/`to`/milestone/`or`/snapshot/`as appropriate.

Once configured, you can add dependencies in the usual way. For example \(in`ivy.xml`\):

```xml
<dependency org="org.springframework"
	name="spring-core" rev="5.0.0.M4" conf="compile->runtime"/>
```

#### Distribution Zip Files

Although using a build system that supports dependency management is the recommended way to obtain the Spring Framework, it is still possible to download a distribution zip file.

Distribution zips are published to the Spring Maven Repository \(this is just for our convenience, you don’t need Maven or any other build system in order to download them\).

To download a distribution zip open a web browser to[http://repo.spring.io/release/org/springframework/spring](http://repo.spring.io/release/org/springframework/spring)and select the appropriate subfolder for the version that you want. Distribution files end`-dist.zip`, for example spring-framework-{spring-version}-RELEASE-dist.zip. Distributions are also published for[milestones](http://repo.spring.io/milestone/org/springframework/spring)and[snapshots](http://repo.spring.io/snapshot/org/springframework/spring).

